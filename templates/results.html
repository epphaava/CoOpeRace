{% block head %}
<link rel="stylesheet" href="../static/css/main.css">
<title>CoOpeRace: Results</title>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="../static/js/script.js"></script>
{% endblock %}

{% block body %}

<div class="container">

  <h1>Results for {{ filename }}</h1>
{% if analysis_results %}

<table id="race_rows_table">

  <thead>
    <tr>
      <th>Line Number</th>
      {% for analyzer in analyzers_for_table %}
        <th>{{ analyzer.upper() }}</th>
      {% endfor %}
    </tr>
  </thead>

  <tbody>

    {% for key in analysis_results %}
    <tr id="line-nr-row" class="clickable-row" data-key="{{ key }}">

      <td>{{ key }}</td>

      {% for analyzer in analyzers_for_table %}
      
      <td>
        {% for el in  get_targetvars(analysis_results.get(key)) if (analyzer in get_analyzers(analysis_results.get(key)) ) %}
        {{ el }}
        {% endfor %}
        </td>
      {% endfor %}

    </tr>

    <tr id="hidden-table{{ key }}" class="hidden-table" style="display: none;">
      <td colspan="{{ analyzers_for_table|length + 1 }}">

        {% for analyzer in analyzers_for_table %}

        <table class="analyzer-table">
          <tr>
            <th>{{ analyzer.upper() }}</th>
          </tr>
          {% set elements = get_analyzer_line(analyzer, analysis_results.get(key)) %}
          {% if elements is not none %}
            {% for el in elements %}
            <tr class="warning-line-row" data-key="{{ key }}" data-analyzer="{{ analyzer }}">
              <td class="highlightable-line">{{ el }}</td>
              <br>
            </tr>
            {% endfor %}
          {% endif %}
        </table>
        

        <table>
          <tr id="warning-paragraph{{ key }}{{ analyzer }}" class="warning-paragraph" style="display: none;">
            <td colspan="{{ analyzers_for_table|length + 1 }}">
              {% set elements = get_analyzer_group(analyzer, analysis_results.get(key)) %}
              {% if elements is not none %}
                {% for el in elements %}
                  {{ el }}
                  <br>
                {% endfor %}
              {% endif %}
            </td>
          </tr>
        </table>
        
        {% endfor %}

      </td>
    </tr>
    {% endfor %}

  </tbody>
</table>
{% else %}
  <tr>
      <td id="no-races-found" colspan="{{ analyzers_for_table|length + 1 }}">No data races found!</td>
  </tr>
{% endif %}
{% endblock %}
